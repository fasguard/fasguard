# Copyright David Abrahams 2006. Distributed under the Boost
# Software License, Version 1.0. (See accompanying
# file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

import python ;

if ! [ python.configured ]
{
    ECHO "notice: no Python configured in user-config.jam" ;
    ECHO "notice: will use default configuration" ;
    using python ;
}

# Specify the path to the Boost project.  If you move this project,
# adjust this path to refer to the Boost root directory.
use-project boost
  : ../../../../../boost-standalone/boost_1_59_0 ;

project
  : requirements
    <library>/boost/python//boost_python
    <library-file>/home/dwyschogrod/fasguard-git/fasguard/fasguardlib-filter/src/libBloom.so
    <implicit-dependency>/boost//headers
    <include>/home/dwyschogrod/fasguard-git/fasguard/fasguardlib-filter/src
    <include>../../../../../boost-local/include
    <toolset>gcc:<cxxflags>-std=gnu++0x
    <toolset>gcc:<cxxflags>-D=BOOST_LOG_DYN_LINK
    <toolset>gcc:<cxxflags>-D=BOOST_REGEX_DYN_LINK
    <toolset>clang:<cxxflags>-std=c++11
  : usage-requirements
    <implicit-dependency>/boost//headers
  ;

python-extension asg_engine_ext
  : # sources
    AbstractTrieNode.cpp
    AsgEngine.cpp
    Dendrogram.cpp
    LocalAlignment.cpp
    RegexExtractorLCSS.cpp
    SmlLrgSigExtrct.cpp
    SuricataRuleMaker.cpp
    Trie.cpp
    ../DetectorReports/DetectorReport.cpp
    ../../../../../boost-local/lib/libboost_log.so.1.59.0
    ../../../../../boost-local/lib/libboost_regex.so.1.59.0
    /usr/lib/libcrypto++.so.9.0.0
    /home/dwyschogrod/fasguard-git/fasguard/fasguardlib-filter/src/libBloom.so
  ;

# Put the extension and Boost.Python DLL in the current directory, so
# that running script by hand works.
install convenient_copy
  : asg_engine_ext
  : # requirements
    <install-dependencies>on
    <install-type>SHARED_LIB
    <install-type>PYTHON_EXTENSION
    <location>.
  ;

# A little "rule" (function) to clean up the syntax of declaring tests
# of these extension modules.
local rule run-test ( test-name : sources + )
{
    import testing ;
    testing.make-test run-pyd : $(sources) : : $(test-name) ;
}

# Declare test targets
run-test asg_engine
  : asg_engine_ext ../testASG.py
  ;
